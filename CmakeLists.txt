cmake_minimum_required(VERSION 3.10)
project(Amtal)

# Use C++17
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

enable_testing()

# Find the Google Test package
find_package(GTest REQUIRED)

# Include directories for header files
include_directories(
    ${CMAKE_SOURCE_DIR}/include
    ${CMAKE_SOURCE_DIR}/lib/asio/asio/include
    ${GTEST_INCLUDE_DIRS} # Use the include directories from the GTest package
)

# Add definitions for ASIO
add_definitions(-DASIO_STANDALONE)



# Source files
file(GLOB_RECURSE SOURCES "src/cpp/*.cpp")

file(GLOB TEST_SOURCES "tests/cpp/*.cpp")

# Executable
add_executable(${PROJECT_NAME} ${SOURCES})

# Tests
add_executable(Tests ${TEST_SOURCES} ${SOURCES})

target_compile_definitions(Tests PRIVATE RUNNING_TESTS)

# Link the Google Test libraries
target_link_libraries(Tests GTest::Main ${GTEST_LIBRARIES} pthread)

add_test(NAME Tests COMMAND Tests)
